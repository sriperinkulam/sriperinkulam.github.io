<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Nextcloud-Box on Srikanth Perinkulam</title>
    <link>https://srikanthperinkulam.com/tags/nextcloud-box/</link>
    <description>Recent content in Nextcloud-Box on Srikanth Perinkulam</description>
    <image>
      <url>https://srikanthperinkulam.com/images/favicon/apple-touch-icon.png</url>
      <link>https://srikanthperinkulam.com/images/favicon/apple-touch-icon.png</link>
    </image>
    <generator>Hugo -- gohugo.io</generator>
    <language>en</language>
    <lastBuildDate>Mon, 09 Jul 2018 00:00:00 +0000</lastBuildDate><atom:link href="https://srikanthperinkulam.com/tags/nextcloud-box/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>09 Jul 2018 00:00</title>
      <link>https://srikanthperinkulam.com/2018/07/09/snappy-nextcloud/</link>
      <pubDate>Mon, 09 Jul 2018 00:00:00 +0000</pubDate>
      
      <guid>https://srikanthperinkulam.com/2018/07/09/snappy-nextcloud/</guid>
      <description>&lt;p&gt;Last year, I procured a &lt;a href=&#34;https://nextcloud.com/box/&#34;&gt;Nextcloud box&lt;/a&gt; and moved part of my data to it. I&amp;rsquo;d just heard about &lt;a href=&#34;https://srikanthperinkulam.com/2017/11/04/fired-up/&#34;&gt;Ubuntu Snappy Core OS&lt;/a&gt; and was keen on porting my install to that setup. I finally got around doing that last week and thought I&amp;rsquo;d quickly jot down the install steps for reference later. Essentially, I installed the Core OS on a 32GB microSD card and installed Nextcloud as a snap. Two 1TB hard drives service the Pi3 and are synced with rclone. Below is a crude outline of the setup:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Install and sign-in to the UbuntuCore OS:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;1.Download the latest &lt;a href=&#34;https://www.ubuntu.com/core&#34;&gt;Ubuntu Core OS&lt;/a&gt; and use &lt;a href=&#34;https://etcher.io/&#34;&gt;Etcher&lt;/a&gt; to burn it on to a microSSD card.&lt;/p&gt;
&lt;p&gt;2.On your local machine generate a public/private rsa key using the following command: &lt;code&gt;ssh-keygen -t rsa&lt;/code&gt; Create an &lt;a href=&#34;https://login.ubuntu.com/&#34;&gt;UbuntuOne&lt;/a&gt; account if you don&amp;rsquo;t already have one and import your ssh key to your account. You&amp;rsquo;ll need this to ssh into your Core OS pretty soon.&lt;/p&gt;
&lt;p&gt;3.Slide in the microSSD card onto the Pi3 board. Then connect a monitor, keyboard and hard drive to the Pi3 and power it on. The Pi3 Board B comes with in-built wi-fi and bluetooth and once powered on it should automatically prompt you to connect to the wi-fi and then to your UbuntuONE account. Once this is setup, you should be able to ssh into the CoreOS from your local machine using: &lt;code&gt;ssh ubuntu-username@192.168.0.xx&lt;/code&gt; [btw] If ssh fails - &amp;ldquo;Error - signandsend_pubkey: signing failed: agent refused operation&amp;rdquo;. This is most likely because the ssh agent is already running but isn&amp;rsquo;t able to find the private keys. To add the keys to the authentication agent, enter &lt;code&gt;ssh-add&lt;/code&gt;. Also to see list of fingerprints of all identities added use &lt;code&gt;ssh-add -l&lt;/code&gt; [/btw][btw]To add a password for the user: &lt;code&gt;sudo passwd ubuntu-username&lt;/code&gt;[/btw][btw]To re-configure network at anytime: &lt;code&gt;sudo console-conf&lt;/code&gt;[/btw]&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;External Drive setup&lt;/strong&gt; 1.I use two external hard-drives one as a primary and the other as a secondary. First format the drives: &lt;code&gt;sudo fdisk /dev/sda&lt;/code&gt; [btw]&lt;code&gt;Welcome to fdisk (util-linux 2.27.1). Changes will remain in memory only, until you decide to write them. Be careful before using the write command. Command (m for help): o Created a new DOS disklabel with disk identifier 0x8b913f43. Command (m for help): n Partition type p primary (0 primary, 0 extended, 4 free) e extended (container for logical partitions) Select (default p): p Partition number (1-4, default 1): First sector (2048-1953458175, default 2048): Last sector, +sectors or +size{K,M,G,T,P} (2048-1953458175, default 1953458175): Created a new partition 1 of type &#39;Linux&#39; and of size 931.5 GiB. Command (m for help): w The partition table has been altered. Calling ioctl() to re-read partition table. Syncing disks.&lt;/code&gt; [/btw]&lt;/p&gt;
&lt;p&gt;2.Format the partition and give it the label data. This label will be used to reference it for mounting later: &lt;code&gt;sudo mkfs.ext4 -L data /dev/sda1&lt;/code&gt; [btw] mke2fs 1.42.13 (17-May-2015) /dev/sda1 contains a ext4 file system labelled &amp;lsquo;data&amp;rsquo; last mounted on Sat Nov 18 08:38:49 2017 Proceed anyway? (y,n) y Creating filesystem with 244182016 4k blocks and 61046784 inodes Filesystem UUID: c03685e6-fc4d-4d69-b8cf-8b17b24f2e0a Superblock backups stored on blocks: 32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208, 4096000, 7962624, 11239424, 20480000, 23887872, 71663616, 78675968, 102400000, 214990848 Allocating group tables: done&lt;br&gt;
Writing inode tables: done&lt;br&gt;
Creating journal (32768 blocks): done Writing superblocks and filesystem accounting information: done [/btw]&lt;/p&gt;
&lt;p&gt;3.To mount the partition we&amp;rsquo;re forced to rely on systemd since most of Ubuntu core system is read-only and editing /etc/fstab is not an option. Mount units need to be named after the mount point directories they control. So create the media-data.mount unit: &lt;code&gt;sudo vi /writable/system-data/etc/systemd/system/media-data.mount&lt;/code&gt; and add in the following content: &lt;code&gt;[Unit] Description=Mount unit for data [Mount] What=/dev/disk/by-label/data Where=/media/data Type=ext4 [Install] WantedBy=multi-user.target&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;4.Reload systemd to reflect the changes,Start and enable the mount volume so it gets automatically mounted: &lt;code&gt;sudo systemctl daemon-reload sudo systemctl start media-data.mount sudo systemctl enable media-data.mount&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;5.Make sure Ubuntucore is up to date and refresh: &lt;code&gt;sudo snap refresh sudo reboot&lt;/code&gt; After the reboot make sure /media/data is mounted and functional: &lt;code&gt;sudo systemctl status media-data.mount&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Install and configure Nextcloud as a snap&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;1.Install Nextcloud: &lt;code&gt;sudo snap install nextcloud&lt;/code&gt; 2.Access the nextcloud install from any browser in the network using the IP address: &lt;a href=&#34;http://192.168.0.xx&#34;&gt;http://192.168.0.xx&lt;/a&gt;, create an admin account and complete the installation. 3.Enable the &amp;lsquo;External Storages&amp;rsquo; app under &amp;lsquo;Apps&amp;rsquo;. 4.Associate the removable media with nextcloud: &lt;code&gt;sudo snap connect nextcloud:removable-media core:removable-media&lt;/code&gt; 5.Map /media/data with nextcloud in the external storage with the following settings: &lt;code&gt;Folder name: data External storage: Local Authentication: None Configuration: /media/data Available for: All&lt;/code&gt; 6.Setup encryption certificates: &lt;code&gt;sudo nextcloud.enable-https self-signed&lt;/code&gt; 7.To access the setup pi3 server from outside the local network, you&amp;rsquo;ll need to map the dynamic dns provided by your ISP to a global address. I used no-ip and my netgear router to facilitate this. 8. Do note that when you upload files, by default they&amp;rsquo;re saved to the microSD card!![btw]here: /var/snap/nextcloud/common/nextcloud/data/&lt;em&gt;NC_user&lt;/em&gt;/files[/btw]. Read &lt;a href=&#34;https://help.nextcloud.com/t/is-there-a-safe-and-reliable-way-to-move-data-directory-out-of-web-root/3642/51&#34;&gt;this forum&lt;/a&gt; for details. 9. If more than one user would be using the external data mount either install the &amp;lsquo;File access control&amp;rsquo; app and setup rules or create folders for each person and just mount those folders for each user in the Nextcloud admin panel.&lt;/p&gt;
</description>
      <content:encoded><![CDATA[<p>Last year, I procured a <a href="https://nextcloud.com/box/">Nextcloud box</a> and moved part of my data to it. I&rsquo;d just heard about <a href="https://srikanthperinkulam.com/2017/11/04/fired-up/">Ubuntu Snappy Core OS</a> and was keen on porting my install to that setup. I finally got around doing that last week and thought I&rsquo;d quickly jot down the install steps for reference later. Essentially, I installed the Core OS on a 32GB microSD card and installed Nextcloud as a snap. Two 1TB hard drives service the Pi3 and are synced with rclone. Below is a crude outline of the setup:</p>
<p><strong>Install and sign-in to the UbuntuCore OS:</strong></p>
<p>1.Download the latest <a href="https://www.ubuntu.com/core">Ubuntu Core OS</a> and use <a href="https://etcher.io/">Etcher</a> to burn it on to a microSSD card.</p>
<p>2.On your local machine generate a public/private rsa key using the following command: <code>ssh-keygen -t rsa</code> Create an <a href="https://login.ubuntu.com/">UbuntuOne</a> account if you don&rsquo;t already have one and import your ssh key to your account. You&rsquo;ll need this to ssh into your Core OS pretty soon.</p>
<p>3.Slide in the microSSD card onto the Pi3 board. Then connect a monitor, keyboard and hard drive to the Pi3 and power it on. The Pi3 Board B comes with in-built wi-fi and bluetooth and once powered on it should automatically prompt you to connect to the wi-fi and then to your UbuntuONE account. Once this is setup, you should be able to ssh into the CoreOS from your local machine using: <code>ssh ubuntu-username@192.168.0.xx</code> [btw] If ssh fails - &ldquo;Error - signandsend_pubkey: signing failed: agent refused operation&rdquo;. This is most likely because the ssh agent is already running but isn&rsquo;t able to find the private keys. To add the keys to the authentication agent, enter <code>ssh-add</code>. Also to see list of fingerprints of all identities added use <code>ssh-add -l</code> [/btw][btw]To add a password for the user: <code>sudo passwd ubuntu-username</code>[/btw][btw]To re-configure network at anytime: <code>sudo console-conf</code>[/btw]</p>
<p><strong>External Drive setup</strong> 1.I use two external hard-drives one as a primary and the other as a secondary. First format the drives: <code>sudo fdisk /dev/sda</code> [btw]<code>Welcome to fdisk (util-linux 2.27.1). Changes will remain in memory only, until you decide to write them. Be careful before using the write command. Command (m for help): o Created a new DOS disklabel with disk identifier 0x8b913f43. Command (m for help): n Partition type p primary (0 primary, 0 extended, 4 free) e extended (container for logical partitions) Select (default p): p Partition number (1-4, default 1): First sector (2048-1953458175, default 2048): Last sector, +sectors or +size{K,M,G,T,P} (2048-1953458175, default 1953458175): Created a new partition 1 of type 'Linux' and of size 931.5 GiB. Command (m for help): w The partition table has been altered. Calling ioctl() to re-read partition table. Syncing disks.</code> [/btw]</p>
<p>2.Format the partition and give it the label data. This label will be used to reference it for mounting later: <code>sudo mkfs.ext4 -L data /dev/sda1</code> [btw] mke2fs 1.42.13 (17-May-2015) /dev/sda1 contains a ext4 file system labelled &lsquo;data&rsquo; last mounted on Sat Nov 18 08:38:49 2017 Proceed anyway? (y,n) y Creating filesystem with 244182016 4k blocks and 61046784 inodes Filesystem UUID: c03685e6-fc4d-4d69-b8cf-8b17b24f2e0a Superblock backups stored on blocks: 32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208, 4096000, 7962624, 11239424, 20480000, 23887872, 71663616, 78675968, 102400000, 214990848 Allocating group tables: done<br>
Writing inode tables: done<br>
Creating journal (32768 blocks): done Writing superblocks and filesystem accounting information: done [/btw]</p>
<p>3.To mount the partition we&rsquo;re forced to rely on systemd since most of Ubuntu core system is read-only and editing /etc/fstab is not an option. Mount units need to be named after the mount point directories they control. So create the media-data.mount unit: <code>sudo vi /writable/system-data/etc/systemd/system/media-data.mount</code> and add in the following content: <code>[Unit] Description=Mount unit for data [Mount] What=/dev/disk/by-label/data Where=/media/data Type=ext4 [Install] WantedBy=multi-user.target</code></p>
<p>4.Reload systemd to reflect the changes,Start and enable the mount volume so it gets automatically mounted: <code>sudo systemctl daemon-reload sudo systemctl start media-data.mount sudo systemctl enable media-data.mount</code></p>
<p>5.Make sure Ubuntucore is up to date and refresh: <code>sudo snap refresh sudo reboot</code> After the reboot make sure /media/data is mounted and functional: <code>sudo systemctl status media-data.mount</code></p>
<p><strong>Install and configure Nextcloud as a snap</strong></p>
<p>1.Install Nextcloud: <code>sudo snap install nextcloud</code> 2.Access the nextcloud install from any browser in the network using the IP address: <a href="http://192.168.0.xx">http://192.168.0.xx</a>, create an admin account and complete the installation. 3.Enable the &lsquo;External Storages&rsquo; app under &lsquo;Apps&rsquo;. 4.Associate the removable media with nextcloud: <code>sudo snap connect nextcloud:removable-media core:removable-media</code> 5.Map /media/data with nextcloud in the external storage with the following settings: <code>Folder name: data External storage: Local Authentication: None Configuration: /media/data Available for: All</code> 6.Setup encryption certificates: <code>sudo nextcloud.enable-https self-signed</code> 7.To access the setup pi3 server from outside the local network, you&rsquo;ll need to map the dynamic dns provided by your ISP to a global address. I used no-ip and my netgear router to facilitate this. 8. Do note that when you upload files, by default they&rsquo;re saved to the microSD card!![btw]here: /var/snap/nextcloud/common/nextcloud/data/<em>NC_user</em>/files[/btw]. Read <a href="https://help.nextcloud.com/t/is-there-a-safe-and-reliable-way-to-move-data-directory-out-of-web-root/3642/51">this forum</a> for details. 9. If more than one user would be using the external data mount either install the &lsquo;File access control&rsquo; app and setup rules or create folders for each person and just mount those folders for each user in the Nextcloud admin panel.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>04 Nov 2017 00:00</title>
      <link>https://srikanthperinkulam.com/2017/11/04/fired-up/</link>
      <pubDate>Sat, 04 Nov 2017 00:00:00 +0000</pubDate>
      
      <guid>https://srikanthperinkulam.com/2017/11/04/fired-up/</guid>
      <description>&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;images/1509819219.jpg&#34; alt=&#34;&#34;  /&gt;

Finally got around procuring a &lt;a href=&#34;https://www.raspberrypi.org/products/raspberry-pi-3-model-b/&#34;&gt;pi3&lt;/a&gt; and setup the &lt;a href=&#34;https://nextcloud.com/box&#34;&gt;Nextcloud Box&lt;/a&gt;! Getting this up and running was super fun and pretty straight forward.&lt;/p&gt;
&lt;p&gt;The OS Image that was delivered with the box was built for the pi2. So I had to format the drive with Gparted and flashed the pi3 image with &lt;a href=&#34;https://etcher.io/&#34;&gt;Etcher&lt;/a&gt; (One nifty piece of software!). Once the hardware was fired up, it just took care of itself. The web install was a 1-click setup.&lt;/p&gt;
&lt;p&gt;Early this year as I initiated taking more control over my data, I also setup a &lt;a href=&#34;https://meandsri.ddns.net&#34;&gt;Nextcloud server on the cloud&lt;/a&gt;. It&amp;rsquo;s been about eight months now and am thoroughly impressed with it. With the incredible iOS and android apps and the nifty client for linux I&amp;rsquo;m more than convinced the take this a step further and setup my personal home server.&lt;/p&gt;
&lt;p&gt;Over the next few weeks as I tinker more with this, I need to make this a more robust setup and make full use of the snappy Ubuntu core.&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;images/cropped-cropped-SP01-550afdebv1_site_icon.png&#34; alt=&#34;&#34;  /&gt;
&lt;a href=&#34;https://srikanthperinkulam.com&#34;&gt;Srikanth Perinkulam&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;images/cropped-cropped-SP01-550afdebv1_site_icon.png&#34; alt=&#34;&#34;  /&gt;
&lt;a href=&#34;https://srikanthperinkulam.com&#34;&gt;Srikanth Perinkulam&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://twitter.com/intent/favorite?tweet_id=926942668512428032&#34;&gt;like&lt;/a&gt; &lt;a href=&#34;https://twitter.com/intent/tweet?tweet_id=926942668512428032&#34;&gt;reply&lt;/a&gt; &lt;a href=&#34;https://twitter.com/intent/retweet?tweet_id=926942668512428032&#34;&gt;repost&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://twitter.com/intent/favorite?tweet_id=926942668512428032&#34;&gt;like&lt;/a&gt; &lt;a href=&#34;https://twitter.com/intent/tweet?tweet_id=926942668512428032&#34;&gt;reply&lt;/a&gt; &lt;a href=&#34;https://twitter.com/intent/retweet?tweet_id=926942668512428032&#34;&gt;repost&lt;/a&gt;&lt;/p&gt;
</description>
      <content:encoded><![CDATA[<p><img loading="lazy" src="images/1509819219.jpg" alt=""  />

Finally got around procuring a <a href="https://www.raspberrypi.org/products/raspberry-pi-3-model-b/">pi3</a> and setup the <a href="https://nextcloud.com/box">Nextcloud Box</a>! Getting this up and running was super fun and pretty straight forward.</p>
<p>The OS Image that was delivered with the box was built for the pi2. So I had to format the drive with Gparted and flashed the pi3 image with <a href="https://etcher.io/">Etcher</a> (One nifty piece of software!). Once the hardware was fired up, it just took care of itself. The web install was a 1-click setup.</p>
<p>Early this year as I initiated taking more control over my data, I also setup a <a href="https://meandsri.ddns.net">Nextcloud server on the cloud</a>. It&rsquo;s been about eight months now and am thoroughly impressed with it. With the incredible iOS and android apps and the nifty client for linux I&rsquo;m more than convinced the take this a step further and setup my personal home server.</p>
<p>Over the next few weeks as I tinker more with this, I need to make this a more robust setup and make full use of the snappy Ubuntu core.</p>
<p><img loading="lazy" src="images/cropped-cropped-SP01-550afdebv1_site_icon.png" alt=""  />
<a href="https://srikanthperinkulam.com">Srikanth Perinkulam</a></p>
<p><img loading="lazy" src="images/cropped-cropped-SP01-550afdebv1_site_icon.png" alt=""  />
<a href="https://srikanthperinkulam.com">Srikanth Perinkulam</a></p>
<p><a href="https://twitter.com/intent/favorite?tweet_id=926942668512428032">like</a> <a href="https://twitter.com/intent/tweet?tweet_id=926942668512428032">reply</a> <a href="https://twitter.com/intent/retweet?tweet_id=926942668512428032">repost</a></p>
<p><a href="https://twitter.com/intent/favorite?tweet_id=926942668512428032">like</a> <a href="https://twitter.com/intent/tweet?tweet_id=926942668512428032">reply</a> <a href="https://twitter.com/intent/retweet?tweet_id=926942668512428032">repost</a></p>
]]></content:encoded>
    </item>
    
  </channel>
</rss>
