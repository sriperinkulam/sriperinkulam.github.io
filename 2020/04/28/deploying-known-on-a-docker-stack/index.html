<!doctype html><html lang=en dir=auto><head><meta name=robots content="noindex"><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Deploying Known on a docker stack | Srikanth Perinkulam</title>
<meta name=keywords content="docker-build,docker-stack,idno,indieweb,known,php,withknown"><meta name=description content="To migrate my php applications that did not have a handy docker-compose available, I needed a vanilla setup for my stack-based docker environment. Known is one of those apps and so the first step was to build that PHP environment.
Setting up a Dockerhub repository and building a custom PHP image
[If you decide to use my image, you would not have to build this yourself. Skip ahead to the Deploying Known section]"><meta name=author content="map[email:ssp+hugo[at]srkn.anonaddy.com name:Srikanth Perinkulam nick:SSP]"><link rel=canonical href=https://srikanthperinkulam.com/2020/04/28/deploying-known-on-a-docker-stack/><link crossorigin=anonymous href=/assets/css/stylesheet.c414ec78f02d9bf14aa9e0a3161730f428146a7569ef646e3529dd09d2c19f23.css integrity="sha256-xBTsePAtm/FKqeCjFhcw9CgUanVp72RuNSndCdLBnyM=" rel="preload stylesheet" as=style><link rel=icon href=https://srikanthperinkulam.com/images/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://srikanthperinkulam.com/images/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://srikanthperinkulam.com/images/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://srikanthperinkulam.com/images/favicon/apple-touch-icon.png><link rel=mask-icon href=https://srikanthperinkulam.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://srikanthperinkulam.com/2020/04/28/deploying-known-on-a-docker-stack/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=webmention href=https://webmention.io/srikanthperinkulam.com/webmention><link rel=alternate type=text/mf2+html href=https://srikanthperinkulam.com/hfeed><link rel=feed type=text/html href=https://srikanthperinkulam.com/hfeed><script data-goatcounter=https://ssp.goatcounter.com/count async src=//gc.zgo.at/count.js></script><meta property="og:title" content="Deploying Known on a docker stack"><meta property="og:description" content="To migrate my php applications that did not have a handy docker-compose available, I needed a vanilla setup for my stack-based docker environment. Known is one of those apps and so the first step was to build that PHP environment.
Setting up a Dockerhub repository and building a custom PHP image
[If you decide to use my image, you would not have to build this yourself. Skip ahead to the Deploying Known section]"><meta property="og:type" content="article"><meta property="og:url" content="https://srikanthperinkulam.com/2020/04/28/deploying-known-on-a-docker-stack/"><meta property="og:image" content="https://srikanthperinkulam.com/images/favicon/apple-touch-icon.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-04-28T00:00:00+00:00"><meta property="article:modified_time" content="2020-04-28T00:00:00+00:00"><meta property="og:site_name" content="Srikanth Perinkulam"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://srikanthperinkulam.com/images/favicon/apple-touch-icon.png"><meta name=twitter:title content="Deploying Known on a docker stack"><meta name=twitter:description content="To migrate my php applications that did not have a handy docker-compose available, I needed a vanilla setup for my stack-based docker environment. Known is one of those apps and so the first step was to build that PHP environment.
Setting up a Dockerhub repository and building a custom PHP image
[If you decide to use my image, you would not have to build this yourself. Skip ahead to the Deploying Known section]"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://srikanthperinkulam.com/posts/"},{"@type":"ListItem","position":2,"name":"Deploying Known on a docker stack","item":"https://srikanthperinkulam.com/2020/04/28/deploying-known-on-a-docker-stack/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Deploying Known on a docker stack","name":"Deploying Known on a docker stack","description":"To migrate my php applications that did not have a handy docker-compose available, I needed a vanilla setup for my stack-based docker environment. Known is one of those apps and so the first step was to build that PHP environment.\nSetting up a Dockerhub repository and building a custom PHP image\n[If you decide to use my image, you would not have to build this yourself. Skip ahead to the Deploying Known section]\n","keywords":["docker-build","docker-stack","idno","indieweb","known","php","withknown"],"articleBody":"To migrate my php applications that did not have a handy docker-compose available, I needed a vanilla setup for my stack-based docker environment. Known is one of those apps and so the first step was to build that PHP environment.\nSetting up a Dockerhub repository and building a custom PHP image\n[If you decide to use my image, you would not have to build this yourself. Skip ahead to the Deploying Known section]\nMost php based apps also need specific extensions built-in. While I am sure they’re out there on the Docker hub repository, I was not able to easily find any images that met my specific needs [php extensions for gd, zip, pdo_mysql etc]. So I went ahead and setup my own repository on Docker Hub.\nSomething I learnt today was that a docker stack only accepts pre-built images. Which essentially means you cannot use the regular build command on the fly in your docker-compose file. A quick work-around to that is to build the image locally and then publish it to a public repository from where the stack can easily access it.\nCreate a dockerfile: sudo nano dockerfile Copy over contents from my dockerfile gist. Edit or update if you need any additional extensions. Do note that I am pulling a debian buster image here. An alpine image would be optimal but lets’ run with this for now. Build the image locally: docker build -t sriperinkulam/php-7.4.3-apache-buster-plus:latest . Edit the image and tag name as needed. If your gist file is defined correctly, the image should be ready in a few minutes. It took me a few iterations to get this working with all the extensions I needed and shouldn’t give you any errors during the build process.\nLogin to your Dockerhub repo: docker login Push your image over to your repository: docker push sriperinkulam/php-7.4.3-apache-buster-plus:latest Within a few minutes, your image should be available for easy fetch whenever needed! Setting up and deploying the Known install\nCreate a folder for the known installation: sudo mkdir known \u0026\u0026 cd known\nCopy over my ‘known.yml’ gist from here and paste into a known.yml file. sudo nano known.yml\nThis is where we use the image we built earlier! Make sure you update the passwords there-in.\nCreate an ‘app’ folder. This is where we will copy in the core known package. sudo mkdir app \u0026\u0026 cd app\nMarcus Povey does the heavy lifting of packaging the known install ‘unofficially’. Download his latest pre-packaged release from his portal.\nwget https://withknown.marcus-povey.co.uk/\nFinally unzip/untar the package.\nStep back into the main ‘known’ directory and deploy the stack that we defined in the known.yml file. cd ..\nDOMAIN=known.domain.org SCHEME=https docker stack deploy -c known.yml known\nAssuming you’ve already setup the traefik container, as mentioned in my Jitsi post, you should now have Known up and running. Navigate to the domain and you should see the warmup page.\nKey in the db credentials that you setup in the known.yml file. The database would need to be set as mariadb, since that’s how we’ve defined it in the known.yml file. Also make sure you have the Uploads folder writable by www-data:\nsudo chown -R www-data /var/www/html/Uploads/\nSetup your user account and proceed with the regular administration controls!\n","wordCount":"538","inLanguage":"en","image":"https://srikanthperinkulam.com/images/favicon/apple-touch-icon.png","datePublished":"2020-04-28T00:00:00Z","dateModified":"2020-04-28T00:00:00Z","author":{"@type":"Person","name":{"email":"ssp+hugo[at]srkn.anonaddy.com","name":"Srikanth Perinkulam","nick":"SSP"}},"mainEntityOfPage":{"@type":"WebPage","@id":"https://srikanthperinkulam.com/2020/04/28/deploying-known-on-a-docker-stack/"},"publisher":{"@type":"Organization","name":"Srikanth Perinkulam","logo":{"@type":"ImageObject","url":"https://srikanthperinkulam.com/images/favicon/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://srikanthperinkulam.com/ accesskey=h title="  (Alt + H)"><img src=https://srikanthperinkulam.com/images/favicon/apple-touch-icon.png alt aria-label=logo height=35></a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><button id=menu-trigger aria-haspopup=menu aria-label="Menu Button"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><ul class="menu hidden"><li><a href=https://srikanthperinkulam.com/about/ title=About><span>About</span></a></li><li><a href=https://srikanthperinkulam.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://srikanthperinkulam.com/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://srikanthperinkulam.com/micro/ title=Micro><span>Micro</span></a></li><li><a href=https://srikanthperinkulam.com/now/ title=Now><span>Now</span></a></li><li><a href=https://srikanthperinkulam.com/photos/ title=Photos><span>Photos</span></a></li><li><a href=https://srikanthperinkulam.com/rewind/ title=Rewind><span>Rewind</span></a></li><li><a href=https://srikanthperinkulam.com/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://srikanthperinkulam.com/more/ title=More><span>More</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Deploying Known on a docker stack</h1><div class=post-meta><span title='2020-04-28 00:00:00 +0000 UTC'>April 28, 2020</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;538 words&nbsp;·&nbsp;SSP</div></header><div class=note-x><p><i>This post is 5 years old! Information may be outdated.</i></p><br></div><style>.note{background-color:#007bff;color:#fff;border:none;transition:background-color .3s ease;padding:10px 20px;border-radius:4px}</style><div class=post-content><p>To migrate my php applications that did not have a handy docker-compose available, I needed a vanilla setup for my stack-based docker environment. <a href=https://withknown.com/opensource/>Known</a> is one of those apps and so the first step was to build that PHP environment.</p><p><strong>Setting up a Dockerhub repository and building a custom PHP image</strong></p><p>[If you decide to use my image, you would not have to build this yourself. Skip ahead to the Deploying Known section]</p><p>Most php based apps also need specific extensions built-in. While I am sure they&rsquo;re out there on the Docker hub repository, I was not able to easily find any images that met my specific needs [php extensions for gd, zip, pdo_mysql etc]. So I went ahead and <a href=https://hub.docker.com/r/sriperinkulam/php-7.4.3-apache-buster-plus>setup my own repository on Docker Hub</a>.</p><p>Something I learnt today was that a docker stack only accepts pre-built images. Which essentially means you cannot use the regular <a href=https://docs.docker.com/engine/reference/commandline/build/>build command</a> on the fly in your docker-compose file. A quick work-around to that is to build the image locally and then publish it to a public repository from where the stack can easily access it.</p><ul><li>Create a dockerfile: <code>sudo nano dockerfile</code></li><li>Copy over contents from <a href=https://gist.github.com/sriperinkulam/26d8702d946a8bad22d7623892be816c>my dockerfile gist</a>. Edit or update if you need any additional extensions. Do note that I am pulling a debian buster image here. An alpine image would be optimal but lets&rsquo; run with this for now.</li><li>Build the image locally: <code>docker build -t sriperinkulam/php-7.4.3-apache-buster-plus:latest .</code></li></ul><p>Edit the image and tag name as needed. If your gist file is defined correctly, the image should be ready in a few minutes. It took me a few iterations to get this working with all the extensions I needed and shouldn&rsquo;t give you any errors during the build process.</p><ul><li>Login to your Dockerhub repo: <code>docker login</code></li><li>Push your image over to your repository: <code>docker push sriperinkulam/php-7.4.3-apache-buster-plus:latest</code></li><li>Within a few minutes, your image should be available for easy fetch whenever needed!</li></ul><p> </p><p><strong>Setting up and deploying the Known install</strong></p><ul><li>Create a folder for the known installation:</li></ul><p><code>sudo mkdir known && cd known</code></p><ul><li>Copy over my &lsquo;known.yml&rsquo; gist from <a href=https://gist.github.com/sriperinkulam/9ea9b57a052629ed5b75071c2bafdb00>here</a> and paste into a known.yml file.</li></ul><p><code>sudo nano known.yml</code></p><p>This is where we use the image we built earlier! Make sure you update the passwords there-in.</p><ul><li>Create an &lsquo;app&rsquo; folder. This is where we will copy in the core known package.</li></ul><p><code>sudo mkdir app && cd app</code></p><p><a href=https://www.marcus-povey.co.uk/known/>Marcus Povey</a> does the heavy lifting of packaging the known install &lsquo;unofficially&rsquo;. Download his latest pre-packaged release from <a href=https://withknown.marcus-povey.co.uk/>his portal</a>.</p><p><code>wget https://withknown.marcus-povey.co.uk/&lt;package></code></p><p>Finally unzip/untar the package.</p><ul><li>Step back into the main &lsquo;known&rsquo; directory and deploy the stack that we defined in the known.yml file.</li></ul><p><code>cd ..</code></p><p><code>DOMAIN=known.domain.org SCHEME=https docker stack deploy -c known.yml known</code></p><ul><li><p>Assuming you&rsquo;ve already setup the traefik container, as mentioned in my <a href=https://srikanthperinkulam.com/2020/04/19/self-hosting-jitsi-video-conferencing/>Jitsi post</a>, you should now have Known up and running. Navigate to the domain and you should see the warmup page.</p></li><li><p>Key in the db credentials that you setup in the <em>known.yml</em> file. The database would need to be set as <em>mariadb,</em> since that&rsquo;s how we&rsquo;ve defined it in the known.yml file. Also make sure you have the <em>Uploads</em> folder writable by www-data:</p></li></ul><p><code>sudo chown -R www-data /var/www/html/Uploads/</code></p><p>Setup your user account and proceed with the regular administration controls!</p></div><div class=comments><div id=comments-section><hr><h3>💬 <u>Interactions and Responses</u></h3><div class="comments-display p-6 bg-gray-50 dark:bg-gray-900 rounded-lg shadow-md"><p class="text-gray-500 dark:text-gray-400"></p></div><br><form id=contactForm class=form><input type=text id=hiddenField name=hiddenField style=display:none><div class=form-group><label for=message></label>
<textarea id=message name=message class=form-control placeholder="Type in your comment." rows=3 required style="background-color:#f0f8ff;border:1px solid #007bff"></textarea></div><div class=form-group style=display:flex;justify-content:space-between><div style=flex:1;margin-right:10px><input type=text id=name name=name class=form-control placeholder=Name required style="background-color:#f0f8ff;border:1px solid #007bff"></div><div style=flex:1><input type=email id=email name=email class=form-control placeholder=E-mail required style="background-color:#f0f8ff;border:1px solid #007bff"></div></div><div class=form-group style=margin-top:10px;display:flex;width:100%><input type=url id=website name=website class=form-control placeholder=https:// style="margin-right:10px;background-color:#f0f8ff;border:1px solid #007bff">
<button type=submit class="btn2 btn2-primary" style=flex-shrink:0>Submit</button></div></form><div class=message id=responseMessage style=display:none></div><hr><form id=WebmentionForm action=https://webmention.io/srikanthperinkulam.com/webmention method=POST class=form><label for=webmention-form>This post accepts webmentions. If you've written a response elsewhere, you can enter the web address below. </label><input id=webmention-format type=hidden name=format value=html>
<input id=webmention-target type=hidden name=target value=https://srikanthperinkulam.com/2020/04/28/deploying-known-on-a-docker-stack/><div class=form-group style=display:flex;width:100%><input id=webmention-source width=auto type=url autocomplete=url required pattern=^https?:\/\/(.*) name=source placeholder="URL/Permalink of your article" aria-invalid=true style="background-color:#f0f8ff;border:1px solid #007bff;flex:1;margin-right:10px" class=form-control>
<input id=webmention-submit type=submit name=submit value="Ping me!" class="btn2 btn2-primary" style=flex-shrink:0></div></form><hr></div></div><script>function sanitizeInput(e){const t=document.createElement("div");return t.innerText=e,t.innerHTML}document.getElementById("contactForm").addEventListener("submit",function(e){e.preventDefault();const t="https://gtfy.srkn.org/hugosspcomments",n="https://ntfy.sh/srknalertz",a=document.getElementById("hiddenField").value;if(a){document.getElementById("responseMessage").innerText="Submission rejected due to spam detection.";const e="Spam aborted!";fetch(t,{method:"POST",headers:{"Content-Type":"text/plain",Authorization:"Bearer tk_phfhehnwzk2qi3hdydxo3rxgd193w",Markdown:"yes"},body:e});return}const r=sanitizeInput(document.getElementById("message").value),s=sanitizeInput(document.getElementById("name").value),c=sanitizeInput(document.getElementById("email").value),o=sanitizeInput(document.getElementById("website").value),l=document.title,d=window.location.href,i=`${o?`[@${s}](${o})`:`@*${s}*`} posted this comment on [${l}](${d}): 
${r}. 
E-mail: ${c}`;n===""?fetch(t,{method:"POST",headers:{"Content-Type":"text/plain",Authorization:"Bearer tk_phfhehnwzk2qi3hdydxo3rxgd193w",Markdown:"yes"},body:i}).then(e=>{if(e.ok)showMessage("Thank you. Your comment has been received and will be published once moderated."),document.getElementById("contactForm").reset();else throw new Error("Network response was not ok.")}).catch(e=>{showMessage("There was a problem sending your message."),console.error("There was a problem with the fetch operation:",e)}):fetch(n,{method:"POST",headers:{"Content-Type":"text/plain"},body:i}).then(e=>{if(e.ok)showMessage("Thank you. Your comment has been received and will be published once moderated."),document.getElementById("contactForm").reset();else throw new Error("Network response was not ok.")}).catch(e=>{showMessage("There was a problem sending your message."),console.error("There was a problem with the fetch operation:",e)})});function showMessage(e){const t=document.getElementById("responseMessage");t.innerHTML=e,t.style.display="block",t.classList.add("fade-in"),setTimeout(()=>{t.classList.remove("fade-in")},1e4)}document.getElementById("toggle-comments").addEventListener("click",function(){var e=document.getElementById("comments-section");e.style.display==="none"?(e.style.display="block",this.textContent="💬 Hide Interactions and Comments"):(e.style.display="none",this.textContent="💬 Show Interactions and Comments")})</script><style>.btn{background-color:#00bcd4;color:#fff;border:none;cursor:pointer;transition:background-color .3s ease}.btn:hover{background-color:#066}.btn:focus{outline:none}.container{max-width:600px;margin:auto;padding:5px;background-color:var(--bg-container);border-radius:4px;box-shadow:0 2px 10px rgba(0,0,0,.1)}.form-group{margin-bottom:5px}.form-control{width:100%;padding:5px;border:1px solid var(--border-color);border-radius:4px;background:var(--input-bg);color:#000}.form-control:focus{outline:none;border-color:#007bff;box-shadow:0 0 5px rgba(0,123,255,.5)}.btn2{padding:10px;border:none;border-radius:4px;cursor:pointer}.btn2-primary{background-color:#00bcd4;color:#fff}.btn2-primary:hover{background-color:#066}.message{margin-top:20px;text-align:center;padding:1px;border-radius:5px;background-color:#e7f3fe;color:#31708f;border:1px solid #bce8f1;display:none;opacity:0;transition:opacity .5s ease-in-out}.fade-in{opacity:1}</style><footer class=post-footer><ul class=post-tags><li><a href=https://srikanthperinkulam.com/tags/docker-build/>Docker-Build</a></li><li><a href=https://srikanthperinkulam.com/tags/docker-stack/>Docker-Stack</a></li><li><a href=https://srikanthperinkulam.com/tags/idno/>Idno</a></li><li><a href=https://srikanthperinkulam.com/tags/indieweb/>Indieweb</a></li><li><a href=https://srikanthperinkulam.com/tags/known/>Known</a></li><li><a href=https://srikanthperinkulam.com/tags/php/>Php</a></li><li><a href=https://srikanthperinkulam.com/tags/withknown/>Withknown</a></li></ul><nav class=paginav><a class=prev href=https://srikanthperinkulam.com/2020/04/28/to-migrate-my-php-applications-that-did-not-have-a/><span class=title>« Prev</span><br><span>To migrate my php applications that did not have a</span>
</a><a class=next href=https://srikanthperinkulam.com/2020/04/27/a-glimpse-of-the-past-week-and-the-few-articles-p/><span class=title>Next »</span><br><span>A glimpse of the past week and the few articles, p</span></a></nav></footer></article></main><footer class=footer></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script language=javascript type=text/javascript src=https://srikanthperinkulam.com/menu-trigger.min.aa0f772e61a331c8fc9605144a42cd7b04abce776a74690c1127a739dbfe60cd.js></script><script src=/js/custom.js></script><footer class=footer><section class=h-card><a class="u-url u-uid" href=https://srikanthperinkulam.com/><span class=p-name>Srikanth Perinkulam</span>
</a><span><img class=u-photo src=/images/favicon/favicon-32x32.png style=display:none alt></span>
<span class=p-note><br>Mountains, Family, <a href=https://srikanthperinkulam.com/2021/01/16/lifting-the-veil/>Privacy</a> and everything else.<br>All opinions solely mine.
<span class=p-locality><div class=icon-container><img src=/icons/flag-in-1x1-128px.svg alt="Indian Flag" class=flag-icon>
<img src=/icons/flag-us-1x1-128px.svg alt="American Flag" class=flag-icon>
<a href=https://srikanthperinkulam.com/location/cdmx><img src=/icons/flag-mx-1x1-128px.svg alt="Mexican Flag" class=flag-icon></a>
<a href=https://srikanthperinkulam.com/location/yaounde><img src=/icons/flag-cm-1x1-128px.svg alt="Cameroon Flag" class=flag-icon></a></span><br></div>Contact: <a class=u-url rel=me href=https://micro.blog/sp>Micro.blog</a> |
<a class=u-url rel=me href=https://chat.srkn.org/@ssp>Fediverse</a> |
<a class=u-url rel=me href=https://github.com/sriperinkulam>Github</a></span></section></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>